name: Enshan Forum Auto Checkin

on:
  workflow_dispatch: # 手动触发
  schedule:
    - cron: '30 0 * * *' # 每天北京时间 08:30 运行 (UTC 00:30)

jobs:
  checkin:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Install Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y jq curl

      - name: Run Enshan Script
        env:
          # 从 GitHub Secrets 映射到环境变量
          ENSHAN_COOKIE: ${{ secrets.ENSHAN_COOKIE }}
          BARK_URL: ${{ secrets.BARK_URL }}
        run: |
          chmod +x ./shell/enshan.sh
          ./shell/enshan.sh
